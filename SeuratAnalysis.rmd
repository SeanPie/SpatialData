---
title: "Seurat Analysis on Dummy Data"
author: "Sean Pierre"
date: '2022-06-17'
output: html_document
---

Spatial Transcriptomics Seurat analysis based on: https://satijalab.org/seurat/articles/pbmc3k_tutorial.html
-------------

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(Seurat)
library(patchwork)
```

Loading in the data and creating a Seurat Object

``` {r}
dummy.data <- Read10X(data.dir = "~/Desktop/test/week/outs/filtered_feature_bc_matrix")

dummy <- CreateSeuratObject(counts = dummy.data, project = "dummyKid", min.cells = 3, min.features = 200)
dummy
```

In online example, filtering was done on cells with >5% mitochondrial counts, however in test data, Kidneys have been damaged which would lead to increased mitochondrial expression; Different metrics needed?

FeatureScatter anc be used to visualize feature-feature relationships, as well as, metadata comparison. This can be useful for data filtering. Filtering cells with over 6000/under 500 features or >50% mitochondrial DNA?

```{r}
dummy[["percent.mt"]] <- PercentageFeatureSet(dummy, pattern = "^mt-") #Calculates the percentage of couns originating from a set of features

head(dummy@meta.data, 5) #Meta data for first 5 cells

VlnPlot(dummy, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)

plot1 <- FeatureScatter(dummy, feature1 ="nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(dummy, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot1 + plot2
```

Filtering cells with over 6000/under 500 features or >50% mitochondrial DNA?
Normalizing data by default: normalization.method = "LogNormalize", scale.factor = 10000

``` {r}
dummy <- subset(dummy, subset = nFeature_RNA > 500 & nFeature_RNA < 6000 & percent.mt < 5)
dummy <- NormalizeData(dummy)

dummy <- FindVariableFeatures(dummy, selection.method = "vst", nfeatures = 2000)
top10 <-  head(VariableFeatures(dummy), 10)

plot1 <- VariableFeaturePlot(dummy)
plot2 <- LabelPoints(plot = plot1, points = top10)
plot1 + plot2
```
```
